{
    "version": "5.0.6.6010",
    "description": "WeCom/WXWork/企业微信/WeChat-Work, a professional office management tool for enterprises created by Tencent",
    "homepage": "https://work.weixin.qq.com/",
    "license": {
        "identifier": "Proprietary",
        "url": "https://work.weixin.qq.com/nl/eula"
    },
    "url": "https://dldir1.qq.com/wework/work_weixin/WeCom_5.0.6.6010.exe#/dl.7z",
    "hash": "98dacf965403623df522641f446062df8d9d826d568bc8f1c254be0700d462e4",
    "bin": "WXWork.exe",
    "shortcuts": [
        [
            "WXWork.exe",
            "WeCom"
        ]
    ],
    "pre_install": [
        "Remove-Item \"$dir\\`$PLUGINSDIR\" -Force -Recurse",
        "Remove-Item \"$dir\\Uninstall.exe\" -Force -Recurse",
        ". \"$bucketsdir\\$bucket\\bin\\utils.ps1\"",
        "Write-Host (\"`nPersisting $env:APPDATA\\Tencent\\WXWork ... \") -NoNewline",
        "New-PersistDirectory \"$env:APPDATA\\Tencent\\WXWork\" \"$persist_dir\\AppData\" -Migrate"
    ],
    "pre_uninstall": [
        "$bucket = $install.bucket",
        ". \"$bucketsdir\\$bucket\\bin\\utils.ps1\"",
        "Confirm-Action",
        "Stop-App",
        "Write-Host (\"`nDeleting $env:APPDATA\\VoipNNModel ... \") -f DarkGray -NoNewline",
        "Remove-Item -Path \"$env:AppData\\VoipNNModel\" -Recurse -Force -ErrorAction SilentlyContinue | Out-Null",
        "Write-Host (\"`nDeleting $env:APPDATA\\Tencent\\WXWork ... \") -f DarkGray -NoNewline",
        "Remove-Junction \"$env:APPDATA\\Tencent\\WXWork\" -ErrorAction SilentlyContinue | Out-Null"
    ],
    "checkver": {
        "script": [
            "$url = 'https://work.weixin.qq.com/wework_admin/commdownload?platform=win&from=wwindex'",
            "if ($PSVersionTable.PSVersion.Major -lt 7.0) {",
            "    $req = Invoke-WebRequest -Uri $url -MaximumRedirection 0 -ErrorAction SilentlyContinue",
            "} else {",
            "    $req = Invoke-WebRequest -Uri $url -MaximumRedirection 0 -ErrorAction SilentlyContinue -SkipHttpErrorCheck",
            "}",
            "Write-Output $req.Headers.Location"
        ],
        "regex": "WeCom_([\\d.]+).exe"
    },
    "autoupdate": {
        "url": "https://dldir1.qq.com/wework/work_weixin/WeCom_$version.exe#/dl.7z"
    }
}
